var Xe=Object.defineProperty,Ye=Object.defineProperties;var Ge=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var Fe=(r,e,t)=>e in r?Xe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Me=(r,e)=>{for(var t in e||(e={}))Ze.call(e,t)&&Fe(r,t,e[t]);if(xe)for(var t of xe(e))et.call(e,t)&&Fe(r,t,e[t]);return r},De=(r,e)=>Ye(r,Ge(e));import{S as tt,i as st,s as rt,e as p,t as O,c as _,a as k,h as R,d,b as f,g as J,Q as u,j as Ue,I as je,L as Ae,w as ie,k as U,x as ue,m as j,X as ce,y as fe,a5 as Y,V as te,a4 as at,q as E,o as A,p as me,B as de,_ as lt,R as ot,J as Ne,K as G,n as pe,E as nt}from"../chunks/vendor-e5aa1018.js";import{g as it}from"../chunks/navigation-6e098c45.js";import{s as ut}from"../chunks/stores-75d9f28e.js";import{I as ct}from"../chunks/Info-69c5f299.js";import{V as ft,a as mt}from"../chunks/VisibilityOff-332b0d28.js";import{C as dt}from"../chunks/Controls-d4e3dd65.js";import{n as pt}from"../chunks/NavigationPriorToLogin-733be1a5.js";import{e as _t}from"../chunks/env-cb046133.js";import{g as He}from"../chunks/gqlRequest-8b3b303a.js";import{c as ht}from"../chunks/CurrentUser-cb94d366.js";import{d as gt}from"../chunks/disableInteractablesWhile-0e82c9c8.js";import"../chunks/singletons-d19c42e4.js";import"../chunks/Logo-99862feb.js";const bt=`#graphql
mutation AuthenticateUser ($authenticateUserInput: AuthenticateUserInput!) {
  authenticateUser(AuthenticateUserInput: $authenticateUserInput)
}`;function We(r){let e,t=r[2].email+"",s,a,i,m;return{c(){e=p("p"),s=O(t),this.h()},l(n){e=_(n,"P",{class:!0});var l=k(e);s=R(l,t),l.forEach(d),this.h()},h(){f(e,"class","error-message svelte-18g5m5c")},m(n,l){J(n,e,l),u(e,s),m=!0},p(n,l){(!m||l&4)&&t!==(t=n[2].email+"")&&Ue(s,t)},i(n){m||(je(()=>{i&&i.end(1),a=Ne(e,G,{}),a.start()}),m=!0)},o(n){a&&a.invalidate(),i=Ae(e,G,{}),m=!1},d(n){n&&d(e),n&&i&&i.end()}}}function vt(r){let e,t,s;return{c(){e=p("input"),this.h()},l(a){e=_(a,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){f(e,"type","text"),f(e,"id","log-in-password"),f(e,"class","svelte-18g5m5c")},m(a,i){J(a,e,i),Y(e,r[1]),t||(s=te(e,"input",r[10]),t=!0)},p(a,i){i&2&&e.value!==a[1]&&Y(e,a[1])},d(a){a&&d(e),t=!1,s()}}}function yt(r){let e,t,s;return{c(){e=p("input"),this.h()},l(a){e=_(a,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){f(e,"type","password"),f(e,"id","log-in-password"),f(e,"class","svelte-18g5m5c")},m(a,i){J(a,e,i),Y(e,r[1]),t||(s=te(e,"input",r[9]),t=!0)},p(a,i){i&2&&e.value!==a[1]&&Y(e,a[1])},d(a){a&&d(e),t=!1,s()}}}function kt(r){let e,t;return e=new ft({}),{c(){ie(e.$$.fragment)},l(s){ue(e.$$.fragment,s)},m(s,a){fe(e,s,a),t=!0},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){de(e,s)}}}function wt(r){let e,t;return e=new mt({}),{c(){ie(e.$$.fragment)},l(s){ue(e.$$.fragment,s)},m(s,a){fe(e,s,a),t=!0},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){de(e,s)}}}function Je(r){let e,t=r[2].password+"",s,a,i,m;return{c(){e=p("p"),s=O(t),this.h()},l(n){e=_(n,"P",{class:!0});var l=k(e);s=R(l,t),l.forEach(d),this.h()},h(){f(e,"class","error-message svelte-18g5m5c")},m(n,l){J(n,e,l),u(e,s),m=!0},p(n,l){(!m||l&4)&&t!==(t=n[2].password+"")&&Ue(s,t)},i(n){m||(je(()=>{i&&i.end(1),a=Ne(e,G,{}),a.start()}),m=!0)},o(n){a&&a.invalidate(),i=Ae(e,G,{}),m=!1},d(n){n&&d(e),n&&i&&i.end()}}}function Ke(r){let e,t=r[2].form+"",s,a,i,m;return{c(){e=p("p"),s=O(t),this.h()},l(n){e=_(n,"P",{class:!0});var l=k(e);s=R(l,t),l.forEach(d),this.h()},h(){f(e,"class","error-message svelte-18g5m5c")},m(n,l){J(n,e,l),u(e,s),m=!0},p(n,l){(!m||l&4)&&t!==(t=n[2].form+"")&&Ue(s,t)},i(n){m||(je(()=>{i&&i.end(1),a=Ne(e,G,{}),a.start()}),m=!0)},o(n){a&&a.invalidate(),i=Ae(e,G,{}),m=!1},d(n){n&&d(e),n&&i&&i.end()}}}function Et(r){let e,t,s,a,i,m,n,l,c,K,S,V,Z,q,ee,N,C,Q,I,z,M,w,P,L,_e,se,D,he,ge,re,B,H,x,X,be,ve,ye,$,ke,ae,we,Pe;e=new dt({}),V=new ct({});let h=r[2].email&&(r[5]||Qe)&&We(r);function Le(o,v){return o[3]?yt:vt}let le=Le(r),T=le(r);const Te=[wt,kt],W=[];function qe(o,v){return o[3]?0:1}P=qe(r),L=W[P]=Te[P](r);let g=r[2].password&&r[5]&&Je(r),b=r[2].form&&Ke(r);return{c(){ie(e.$$.fragment),t=U(),s=p("main"),a=p("section"),i=p("h1"),m=O("Log In"),n=U(),l=p("form"),c=p("label"),K=O("Email "),S=p("span"),ie(V.$$.fragment),Z=U(),q=p("input"),ee=U(),h&&h.c(),N=U(),C=p("label"),Q=O("Password"),I=U(),z=p("div"),T.c(),M=U(),w=p("button"),L.c(),_e=U(),g&&g.c(),se=U(),D=p("a"),he=O("Forgot password?"),ge=U(),b&&b.c(),re=U(),B=p("div"),H=p("a"),x=p("button"),X=p("span"),be=O("Not registered yet?"),ve=O(" Register"),ye=U(),$=p("button"),ke=O("Log In"),this.h()},l(o){ue(e.$$.fragment,o),t=j(o),s=_(o,"MAIN",{class:!0});var v=k(s);a=_(v,"SECTION",{class:!0});var F=k(a);i=_(F,"H1",{class:!0});var ze=k(i);m=R(ze,"Log In"),ze.forEach(d),n=j(F),l=_(F,"FORM",{class:!0});var y=k(l);c=_(y,"LABEL",{for:!0});var Ee=k(c);K=R(Ee,"Email "),S=_(Ee,"SPAN",{class:!0,title:!0});var Oe=k(S);ue(V.$$.fragment,Oe),Oe.forEach(d),Ee.forEach(d),Z=j(y),q=_(y,"INPUT",{id:!0}),ee=j(y),h&&h.l(y),N=j(y),C=_(y,"LABEL",{for:!0});var Re=k(C);Q=R(Re,"Password"),Re.forEach(d),I=j(y),z=_(y,"DIV",{class:!0});var oe=k(z);T.l(oe),M=j(oe),w=_(oe,"BUTTON",{type:!0,class:!0});var Se=k(w);L.l(Se),Se.forEach(d),oe.forEach(d),_e=j(y),g&&g.l(y),se=j(y),D=_(y,"A",{class:!0,href:!0});var Ve=k(D);he=R(Ve,"Forgot password?"),Ve.forEach(d),ge=j(y),b&&b.l(y),re=j(y),B=_(y,"DIV",{class:!0});var ne=k(B);H=_(ne,"A",{href:!0,class:!0});var Ce=k(H);x=_(Ce,"BUTTON",{type:!0,class:!0});var Ie=k(x);X=_(Ie,"SPAN",{class:!0});var $e=k(X);be=R($e,"Not registered yet?"),$e.forEach(d),ve=R(Ie," Register"),Ie.forEach(d),Ce.forEach(d),ye=j(ne),$=_(ne,"BUTTON",{type:!0,class:!0});var Be=k($);ke=R(Be,"Log In"),Be.forEach(d),ne.forEach(d),y.forEach(d),F.forEach(d),v.forEach(d),this.h()},h(){f(i,"class","svelte-18g5m5c"),f(S,"class","tooltip-container"),f(S,"title","Your email is used to identify you within the system without having to remember your username, and prevents you from getting locked out of your account in the event you forget your password."),f(c,"for","log-in-email"),f(q,"id","log-in-email"),f(C,"for","log-in-password"),f(w,"type","button"),f(w,"class","secondary svelte-18g5m5c"),ce(w,"disabled",r[4]),f(z,"class","flex svelte-18g5m5c"),f(D,"class","forgot-password svelte-18g5m5c"),f(D,"href","/reset-password"),f(X,"class","svelte-18g5m5c"),f(x,"type","button"),f(x,"class","secondary svelte-18g5m5c"),f(H,"href","/register"),f(H,"class","svelte-18g5m5c"),f($,"type","submit"),f($,"class","primary svelte-18g5m5c"),ce($,"disabled",r[5]&&r[6]),f(B,"class","actions svelte-18g5m5c"),f(l,"class","svelte-18g5m5c"),f(a,"class","log-in svelte-18g5m5c"),f(s,"class","svelte-18g5m5c")},m(o,v){fe(e,o,v),J(o,t,v),J(o,s,v),u(s,a),u(a,i),u(i,m),u(a,n),u(a,l),u(l,c),u(c,K),u(c,S),fe(V,S,null),u(l,Z),u(l,q),Y(q,r[0]),u(l,ee),h&&h.m(l,null),u(l,N),u(l,C),u(C,Q),u(l,I),u(l,z),T.m(z,null),u(z,M),u(z,w),W[P].m(w,null),u(l,_e),g&&g.m(l,null),u(l,se),u(l,D),u(D,he),u(l,ge),b&&b.m(l,null),u(l,re),u(l,B),u(B,H),u(H,x),u(x,X),u(X,be),u(x,ve),u(B,ye),u(B,$),u($,ke),ae=!0,we||(Pe=[te(q,"input",r[8]),te(w,"click",r[11]),te(l,"submit",at(r[7]))],we=!0)},p(o,[v]){v&1&&q.value!==o[0]&&Y(q,o[0]),o[2].email&&(o[5]||Qe)?h?(h.p(o,v),v&36&&E(h,1)):(h=We(o),h.c(),E(h,1),h.m(l,N)):h&&(pe(),A(h,1,1,()=>{h=null}),me()),le===(le=Le(o))&&T?T.p(o,v):(T.d(1),T=le(o),T&&(T.c(),T.m(z,M)));let F=P;P=qe(o),P!==F&&(pe(),A(W[F],1,1,()=>{W[F]=null}),me(),L=W[P],L||(L=W[P]=Te[P](o),L.c()),E(L,1),L.m(w,null)),v&16&&ce(w,"disabled",o[4]),o[2].password&&o[5]?g?(g.p(o,v),v&36&&E(g,1)):(g=Je(o),g.c(),E(g,1),g.m(l,se)):g&&(pe(),A(g,1,1,()=>{g=null}),me()),o[2].form?b?(b.p(o,v),v&4&&E(b,1)):(b=Ke(o),b.c(),E(b,1),b.m(l,re)):b&&(pe(),A(b,1,1,()=>{b=null}),me()),v&96&&ce($,"disabled",o[5]&&o[6])},i(o){ae||(E(e.$$.fragment,o),E(V.$$.fragment,o),E(h),E(L),E(g),E(b),ae=!0)},o(o){A(e.$$.fragment,o),A(V.$$.fragment,o),A(h),A(L),A(g),A(b),ae=!1},d(o){de(e,o),o&&d(t),o&&d(s),de(V),h&&h.d(),T.d(),W[P].d(),g&&g.d(),b&&b.d(),we=!1,lt(Pe)}}}let Qe=!1;function It(r,e,t){let s,a;ot(r,pt,N=>t(12,a=N));let i="",m="",n=!0,l=!1,c={email:"",password:"",form:""},K=!1;const S=async()=>{var C;if(t(2,c.form="",c),await nt(),t(5,K=!0),s)return;t(4,l=!0);const N=await gt(async()=>{var Q;try{const I=await fetch(`${_t.viteSveltekitHost}/proxy/authenticate`,He({query:bt,variables:{authenticateUserInput:{email:i,password:m}}})).then(async w=>await w.json());if((Q=I==null?void 0:I.error)==null?void 0:Q.message)throw I.error.message;const M=await(await fetch("/proxy/current-user",He({query:ht(`
              id
              username
              email
              emailIsVerified
              banned
              createdAt
              cred
              isAdmin
              `)}))).json();return console.log({deserialized:M}),ut.update(w=>De(Me({},w),{user:M})),!0}catch(I){return console.log({error:I}),I==="Unable to find user with provided credentials."&&t(2,c.form=`${I} Please check your email and password, and try again.`,c),!1}});console.log({success:N}),N&&await it((C=a==null?void 0:a.url)!=null?C:"/")};function V(){i=this.value,t(0,i)}function Z(){m=this.value,t(1,m)}function q(){m=this.value,t(1,m)}const ee=()=>t(3,n=!n);return r.$$.update=()=>{r.$$.dirty&5&&t(2,c=(()=>i?i.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/)?(t(2,c.email="",c),c):(t(2,c.email="Email address format invalid",c),c):(t(2,c.email="Email address is required",c),c))()),r.$$.dirty&6&&t(2,c=(()=>m?(t(2,c.password="",c),c):(t(2,c.password="Password is required",c),c))()),r.$$.dirty&4&&t(6,s=Object.values(c).some(N=>!!N))},[i,m,c,n,l,K,s,S,V,Z,q,ee]}class $t extends tt{constructor(e){super();st(this,e,It,Et,rt,{})}}export{$t as default};
