import{S as xe,i as et,s as tt,e as d,t as N,c as h,a as y,h as L,d as p,b as m,g as X,Q as f,j as we,I as ne,L as oe,w as ke,k as I,x as ye,m as P,X as B,y as Ee,a5 as Y,V as se,a4 as rt,q as E,o as q,p as ue,B as Ue,_ as st,ac as lt,J as fe,K as V,n as ce}from"../chunks/vendor-82c75a9c.js";import{I as at}from"../chunks/Info-76630e33.js";import{V as it,a as nt}from"../chunks/VisibilityOff-585519f3.js";import{C as ot}from"../chunks/Controls-cee10546.js";import{e as Qe}from"../chunks/env-66f3c62e.js";import{g as Xe}from"../chunks/gqlRequest-8b3b303a.js";import{d as ut}from"../chunks/disableInteractablesWhile-0e82c9c8.js";import{p as ft,g as ct}from"../chunks/navigation-6e098c45.js";import"../chunks/stores-3e2e9e39.js";import"../chunks/Logo-06ab5db7.js";import"../chunks/singletons-d19c42e4.js";const mt=i=>`#graphql
query UserWhereUniqueInput ($where: UserWhereUniqueInput!) {
  user(where: $where ) {
    ${i}
  }
}
`,pt=`#graphql
mutation RegisterUser($userRegistrationInput: UserRegistrationInput!) {
  registerUser(UserRegistrationInput: $userRegistrationInput)
}
`;function Ye(i){let e,t=i[4].username+"",l,s,u,c;return{c(){e=d("p"),l=N(t),this.h()},l(a){e=h(a,"P",{class:!0});var r=y(e);l=L(r,t),r.forEach(p),this.h()},h(){m(e,"class","error-message svelte-wl0o75")},m(a,r){X(a,e,r),f(e,l),c=!0},p(a,r){(!c||r&16)&&t!==(t=a[4].username+"")&&we(l,t)},i(a){c||(ne(()=>{u&&u.end(1),s=fe(e,V,{}),s.start()}),c=!0)},o(a){s&&s.invalidate(),u=oe(e,V,{}),c=!1},d(a){a&&p(e),a&&u&&u.end()}}}function Ze(i){let e,t=i[4].email+"",l,s,u,c;return{c(){e=d("p"),l=N(t),this.h()},l(a){e=h(a,"P",{class:!0});var r=y(e);l=L(r,t),r.forEach(p),this.h()},h(){m(e,"class","error-message svelte-wl0o75")},m(a,r){X(a,e,r),f(e,l),c=!0},p(a,r){(!c||r&16)&&t!==(t=a[4].email+"")&&we(l,t)},i(a){c||(ne(()=>{u&&u.end(1),s=fe(e,V,{}),s.start()}),c=!0)},o(a){s&&s.invalidate(),u=oe(e,V,{}),c=!1},d(a){a&&p(e),a&&u&&u.end()}}}function _t(i){let e,t,l;return{c(){e=d("input"),this.h()},l(s){e=h(s,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){m(e,"type","text"),m(e,"id","register-password"),m(e,"class","svelte-wl0o75")},m(s,u){X(s,e,u),Y(e,i[3]),t||(l=se(e,"input",i[13]),t=!0)},p(s,u){u&8&&e.value!==s[3]&&Y(e,s[3])},d(s){s&&p(e),t=!1,l()}}}function dt(i){let e,t,l;return{c(){e=d("input"),this.h()},l(s){e=h(s,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){m(e,"type","password"),m(e,"id","register-password"),m(e,"class","svelte-wl0o75")},m(s,u){X(s,e,u),Y(e,i[3]),t||(l=se(e,"input",i[12]),t=!0)},p(s,u){u&8&&e.value!==s[3]&&Y(e,s[3])},d(s){s&&p(e),t=!1,l()}}}function ht(i){let e,t;return e=new it({}),{c(){ke(e.$$.fragment)},l(l){ye(e.$$.fragment,l)},m(l,s){Ee(e,l,s),t=!0},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){Ue(e,l)}}}function bt(i){let e,t;return e=new nt({}),{c(){ke(e.$$.fragment)},l(l){ye(e.$$.fragment,l)},m(l,s){Ee(e,l,s),t=!0},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){Ue(e,l)}}}function Ge(i){let e,t=i[4].password+"",l,s,u,c;return{c(){e=d("p"),l=N(t),this.h()},l(a){e=h(a,"P",{class:!0});var r=y(e);l=L(r,t),r.forEach(p),this.h()},h(){m(e,"class","error-message svelte-wl0o75")},m(a,r){X(a,e,r),f(e,l),c=!0},p(a,r){(!c||r&16)&&t!==(t=a[4].password+"")&&we(l,t)},i(a){c||(ne(()=>{u&&u.end(1),s=fe(e,V,{}),s.start()}),c=!0)},o(a){s&&s.invalidate(),u=oe(e,V,{}),c=!1},d(a){a&&p(e),a&&u&&u.end()}}}function $e(i){let e,t=i[4].form+"",l,s,u,c;return{c(){e=d("p"),l=N(t),this.h()},l(a){e=h(a,"P",{class:!0});var r=y(e);l=L(r,t),r.forEach(p),this.h()},h(){m(e,"class","error-message svelte-wl0o75")},m(a,r){X(a,e,r),f(e,l),c=!0},p(a,r){(!c||r&16)&&t!==(t=a[4].form+"")&&we(l,t)},i(a){c||(ne(()=>{u&&u.end(1),s=fe(e,V,{}),s.start()}),c=!0)},o(a){s&&s.invalidate(),u=oe(e,V,{}),c=!1},d(a){a&&p(e),a&&u&&u.end()}}}function gt(i){let e,t,l,s,u,c,a,r,C,o,x,j,le,ee,W,ae,H,M,O,U,te,D,S,Ie,Pe,F,me,R,A,T,qe,pe,_e,K,Z,G,re,je,Re,Ae,J,Te,de,ie,he,ze,Oe;e=new ot({});let g=i[4].username&&(i[7]||i[1])&&Ye(i);M=new at({});let v=i[4].email&&i[7]&&Ze(i);function Se(n,_){return n[5]?dt:_t}let be=Se(i),z=be(i);const Be=[bt,ht],$=[];function Ve(n,_){return n[5]?0:1}A=Ve(i),T=$[A]=Be[A](i);let w=i[4].password&&i[7]&&Ge(i),k=i[4].form&&$e(i);return{c(){ke(e.$$.fragment),t=I(),l=d("main"),s=d("section"),u=d("h1"),c=N("Register"),a=I(),r=d("form"),C=d("label"),o=N("Username"),x=I(),j=d("input"),le=I(),g&&g.c(),ee=I(),W=d("label"),ae=N("Email "),H=d("span"),ke(M.$$.fragment),O=I(),U=d("input"),te=I(),v&&v.c(),D=I(),S=d("label"),Ie=N("Password"),Pe=I(),F=d("div"),z.c(),me=I(),R=d("button"),T.c(),qe=I(),w&&w.c(),pe=I(),k&&k.c(),_e=I(),K=d("div"),Z=d("a"),G=d("button"),re=d("span"),je=N("Already a member?"),Re=N(" Log In"),Ae=I(),J=d("button"),Te=N("Register"),this.h()},l(n){ye(e.$$.fragment,n),t=P(n),l=h(n,"MAIN",{class:!0});var _=y(l);s=h(_,"SECTION",{class:!0});var Q=y(s);u=h(Q,"H1",{class:!0});var Ce=y(u);c=L(Ce,"Register"),Ce.forEach(p),a=P(Q),r=h(Q,"FORM",{class:!0});var b=y(r);C=h(b,"LABEL",{for:!0});var We=y(C);o=L(We,"Username"),We.forEach(p),x=P(b),j=h(b,"INPUT",{id:!0}),le=P(b),g&&g.l(b),ee=P(b),W=h(b,"LABEL",{for:!0});var Ne=y(W);ae=L(Ne,"Email "),H=h(Ne,"SPAN",{class:!0,title:!0});var He=y(H);ye(M.$$.fragment,He),He.forEach(p),Ne.forEach(p),O=P(b),U=h(b,"INPUT",{id:!0}),te=P(b),v&&v.l(b),D=P(b),S=h(b,"LABEL",{for:!0});var Me=y(S);Ie=L(Me,"Password"),Me.forEach(p),Pe=P(b),F=h(b,"DIV",{class:!0});var ge=y(F);z.l(ge),me=P(ge),R=h(ge,"BUTTON",{type:!0,class:!0});var De=y(R);T.l(De),De.forEach(p),ge.forEach(p),qe=P(b),w&&w.l(b),pe=P(b),k&&k.l(b),_e=P(b),K=h(b,"DIV",{class:!0});var ve=y(K);Z=h(ve,"A",{class:!0,href:!0});var Fe=y(Z);G=h(Fe,"BUTTON",{class:!0});var Le=y(G);re=h(Le,"SPAN",{class:!0});var Je=y(re);je=L(Je,"Already a member?"),Je.forEach(p),Re=L(Le," Log In"),Le.forEach(p),Fe.forEach(p),Ae=P(ve),J=h(ve,"BUTTON",{type:!0,class:!0});var Ke=y(J);Te=L(Ke,"Register"),Ke.forEach(p),ve.forEach(p),b.forEach(p),Q.forEach(p),_.forEach(p),this.h()},h(){m(u,"class","svelte-wl0o75"),m(C,"for","register-username"),m(j,"id","register-username"),B(j,"disabled",i[6]),m(H,"class","tooltip-container"),m(H,"title","Your email is used log in and recover your account if your forget your password."),m(W,"for","register-email"),m(U,"id","register-email"),B(U,"disabled",i[6]),m(S,"for","register-password"),B(S,"disabled",i[6]),m(R,"type","button"),m(R,"class","secondary svelte-wl0o75"),B(R,"disabled",i[6]),m(F,"class","flex svelte-wl0o75"),m(re,"class","svelte-wl0o75"),m(G,"class","secondary svelte-wl0o75"),m(Z,"class","secondary svelte-wl0o75"),m(Z,"href","/log-in"),m(J,"type","submit"),m(J,"class","primary svelte-wl0o75"),B(J,"disabled",i[7]&&i[8]),m(K,"class","actions svelte-wl0o75"),m(r,"class","svelte-wl0o75"),m(s,"class","register svelte-wl0o75"),m(l,"class","svelte-wl0o75")},m(n,_){Ee(e,n,_),X(n,t,_),X(n,l,_),f(l,s),f(s,u),f(u,c),f(s,a),f(s,r),f(r,C),f(C,o),f(r,x),f(r,j),Y(j,i[0]),f(r,le),g&&g.m(r,null),f(r,ee),f(r,W),f(W,ae),f(W,H),Ee(M,H,null),f(r,O),f(r,U),Y(U,i[2]),f(r,te),v&&v.m(r,null),f(r,D),f(r,S),f(S,Ie),f(r,Pe),f(r,F),z.m(F,null),f(F,me),f(F,R),$[A].m(R,null),f(r,qe),w&&w.m(r,null),f(r,pe),k&&k.m(r,null),f(r,_e),f(r,K),f(K,Z),f(Z,G),f(G,re),f(re,je),f(G,Re),f(K,Ae),f(K,J),f(J,Te),he=!0,ze||(Oe=[se(j,"input",i[10]),se(U,"input",i[11]),se(R,"click",i[14]),se(r,"submit",rt(i[9]))],ze=!0)},p(n,[_]){_&1&&j.value!==n[0]&&Y(j,n[0]),_&64&&B(j,"disabled",n[6]),n[4].username&&(n[7]||n[1])?g?(g.p(n,_),_&146&&E(g,1)):(g=Ye(n),g.c(),E(g,1),g.m(r,ee)):g&&(ce(),q(g,1,1,()=>{g=null}),ue()),_&4&&U.value!==n[2]&&Y(U,n[2]),_&64&&B(U,"disabled",n[6]),n[4].email&&n[7]?v?(v.p(n,_),_&144&&E(v,1)):(v=Ze(n),v.c(),E(v,1),v.m(r,D)):v&&(ce(),q(v,1,1,()=>{v=null}),ue()),_&64&&B(S,"disabled",n[6]),be===(be=Se(n))&&z?z.p(n,_):(z.d(1),z=be(n),z&&(z.c(),z.m(F,me)));let Q=A;A=Ve(n),A!==Q&&(ce(),q($[Q],1,1,()=>{$[Q]=null}),ue(),T=$[A],T||(T=$[A]=Be[A](n),T.c()),E(T,1),T.m(R,null)),_&64&&B(R,"disabled",n[6]),n[4].password&&n[7]?w?(w.p(n,_),_&144&&E(w,1)):(w=Ge(n),w.c(),E(w,1),w.m(r,pe)):w&&(ce(),q(w,1,1,()=>{w=null}),ue()),n[4].form?k?(k.p(n,_),_&16&&E(k,1)):(k=$e(n),k.c(),E(k,1),k.m(r,_e)):k&&(ce(),q(k,1,1,()=>{k=null}),ue()),_&384&&B(J,"disabled",n[7]&&n[8])},i(n){he||(E(e.$$.fragment,n),E(g),E(M.$$.fragment,n),E(v),E(T),E(w),E(k),ne(()=>{ie&&ie.end(1),de=fe(s,V,{}),de.start()}),he=!0)},o(n){q(e.$$.fragment,n),q(g),q(M.$$.fragment,n),q(v),q(T),q(w),q(k),de&&de.invalidate(),ie=oe(s,V,{}),he=!1},d(n){Ue(e,n),n&&p(t),n&&p(l),g&&g.d(),Ue(M),v&&v.d(),z.d(),$[A].d(),w&&w.d(),k&&k.d(),n&&ie&&ie.end(),ze=!1,st(Oe)}}}function vt(i,e,t){let l,s="",u=!1,c="",a="",r=!0,C=!1,o={username:"",email:"",password:"",form:""},x=!1;const j=async()=>{if(t(7,x=!0),l)return;t(6,C=!0);let O=!1;await ut(async()=>{var U;try{const[te,D]=await Promise.all([ft("/verify-email"),fetch(`${Qe.viteSveltekitHost}/proxy/register`,Xe({query:pt,variables:{userRegistrationInput:{username:s,email:c,password:a}}})).then(async S=>await S.json())]);if((U=D==null?void 0:D.error)==null?void 0:U.message)throw D.error.message;O=!0}catch(te){if(te==="A user with that username already exists. Please try another."){t(1,u=!0);return}t(4,o.form="An unknown error occurred. Please try again later.",o)}}),O&&await ct("/verify-email")},le=lt(async()=>{const O=await fetch(`${Qe.viteSveltekitHost}/proxy/user-where`,Xe({query:mt("id"),variables:{where:{username:s}}})).then(async U=>await U.json());t(1,u=!!O)},500);function ee(){s=this.value,t(0,s)}function W(){c=this.value,t(2,c)}function ae(){a=this.value,t(3,a)}function H(){a=this.value,t(3,a)}const M=()=>t(5,r=!r);return i.$$.update=()=>{i.$$.dirty&19&&t(4,o=(()=>s?s.length<2?(t(4,o.username="Username must be at least 2 characters",o),o):s.match(/^(?=.{2,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$/)?u?(t(4,o.username="Username is taken. Please choose another.",o),o):(t(4,o.username="",o),o):(t(4,o.username="Username must be alphanumeric. Periods and underscores may only be used as separators.",o),o):(t(4,o.username="Username is required",o),o))()),i.$$.dirty&20&&t(4,o=(()=>c?c.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/)?(t(4,o.email="",o),o):(t(4,o.email="Email address format invalid",o),o):(t(4,o.email="Email address is required",o),o))()),i.$$.dirty&24&&t(4,o=(()=>a?a.length<8?(t(4,o.password="Password must be at least 8 characters in length",o),o):(t(4,o.password="",o),o):(t(4,o.password="Password is required",o),o))()),i.$$.dirty&16&&t(8,l=Object.values(o).some(O=>!!O)),i.$$.dirty&1&&s&&le()},[s,u,c,a,o,r,C,x,l,j,ee,W,ae,H,M]}class Tt extends xe{constructor(e){super();et(this,e,vt,gt,tt,{})}}export{Tt as default};
