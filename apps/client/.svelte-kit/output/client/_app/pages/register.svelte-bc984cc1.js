import{S as xe,i as et,s as tt,e as _,t as L,c as h,a as y,h as O,d as p,b as m,g as Q,Q as f,j as ke,I as oe,L as ue,w as ye,k as I,x as Ee,m as P,X as B,y as Ue,a5 as X,V as re,a4 as rt,q as E,o as q,p as fe,B as Ie,_ as st,J as ce,K as V,n as me,ac as lt}from"../chunks/vendor-7cce70e9.js";import{I as at}from"../chunks/Info-2def3017.js";import{V as it,a as nt}from"../chunks/VisibilityOff-1f106cb8.js";import{C as ot}from"../chunks/Controls-ce70bd57.js";import{e as Qe}from"../chunks/env-cb046133.js";import{g as Xe}from"../chunks/gqlRequest-8b3b303a.js";import{d as ut}from"../chunks/disableInteractablesWhile-0e82c9c8.js";import{p as ft,g as ct}from"../chunks/navigation-6e098c45.js";import"../chunks/stores-2526e4c7.js";import"../chunks/Logo-cf3f36c8.js";import"../chunks/singletons-d19c42e4.js";const mt=l=>`#graphql
query UserWhereUniqueInput ($where: UserWhereUniqueInput!) {
  user(where: $where ) {
    ${l}
  }
}
`,pt=`#graphql
mutation RegisterUser($userRegistrationInput: UserRegistrationInput!) {
  registerUser(UserRegistrationInput: $userRegistrationInput)
}
`;function Ye(l){let e,t=l[4].username+"",s,a,o,c;return{c(){e=_("p"),s=L(t),this.h()},l(i){e=h(i,"P",{class:!0});var r=y(e);s=O(r,t),r.forEach(p),this.h()},h(){m(e,"class","error-message svelte-wl0o75")},m(i,r){Q(i,e,r),f(e,s),c=!0},p(i,r){(!c||r&16)&&t!==(t=i[4].username+"")&&ke(s,t)},i(i){c||(oe(()=>{o&&o.end(1),a=ce(e,V,{}),a.start()}),c=!0)},o(i){a&&a.invalidate(),o=ue(e,V,{}),c=!1},d(i){i&&p(e),i&&o&&o.end()}}}function Ze(l){let e,t=l[4].email+"",s,a,o,c;return{c(){e=_("p"),s=L(t),this.h()},l(i){e=h(i,"P",{class:!0});var r=y(e);s=O(r,t),r.forEach(p),this.h()},h(){m(e,"class","error-message svelte-wl0o75")},m(i,r){Q(i,e,r),f(e,s),c=!0},p(i,r){(!c||r&16)&&t!==(t=i[4].email+"")&&ke(s,t)},i(i){c||(oe(()=>{o&&o.end(1),a=ce(e,V,{}),a.start()}),c=!0)},o(i){a&&a.invalidate(),o=ue(e,V,{}),c=!1},d(i){i&&p(e),i&&o&&o.end()}}}function dt(l){let e,t,s;return{c(){e=_("input"),this.h()},l(a){e=h(a,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){m(e,"type","text"),m(e,"id","register-password"),m(e,"class","svelte-wl0o75")},m(a,o){Q(a,e,o),X(e,l[3]),t||(s=re(e,"input",l[13]),t=!0)},p(a,o){o&8&&e.value!==a[3]&&X(e,a[3])},d(a){a&&p(e),t=!1,s()}}}function _t(l){let e,t,s;return{c(){e=_("input"),this.h()},l(a){e=h(a,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){m(e,"type","password"),m(e,"id","register-password"),m(e,"class","svelte-wl0o75")},m(a,o){Q(a,e,o),X(e,l[3]),t||(s=re(e,"input",l[12]),t=!0)},p(a,o){o&8&&e.value!==a[3]&&X(e,a[3])},d(a){a&&p(e),t=!1,s()}}}function ht(l){let e,t;return e=new it({}),{c(){ye(e.$$.fragment)},l(s){Ee(e.$$.fragment,s)},m(s,a){Ue(e,s,a),t=!0},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){Ie(e,s)}}}function bt(l){let e,t;return e=new nt({}),{c(){ye(e.$$.fragment)},l(s){Ee(e.$$.fragment,s)},m(s,a){Ue(e,s,a),t=!0},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){Ie(e,s)}}}function Ge(l){let e,t=l[4].password+"",s,a,o,c;return{c(){e=_("p"),s=L(t),this.h()},l(i){e=h(i,"P",{class:!0});var r=y(e);s=O(r,t),r.forEach(p),this.h()},h(){m(e,"class","error-message svelte-wl0o75")},m(i,r){Q(i,e,r),f(e,s),c=!0},p(i,r){(!c||r&16)&&t!==(t=i[4].password+"")&&ke(s,t)},i(i){c||(oe(()=>{o&&o.end(1),a=ce(e,V,{}),a.start()}),c=!0)},o(i){a&&a.invalidate(),o=ue(e,V,{}),c=!1},d(i){i&&p(e),i&&o&&o.end()}}}function $e(l){let e,t=l[4].form+"",s,a,o,c;return{c(){e=_("p"),s=L(t),this.h()},l(i){e=h(i,"P",{class:!0});var r=y(e);s=O(r,t),r.forEach(p),this.h()},h(){m(e,"class","error-message svelte-wl0o75")},m(i,r){Q(i,e,r),f(e,s),c=!0},p(i,r){(!c||r&16)&&t!==(t=i[4].form+"")&&ke(s,t)},i(i){c||(oe(()=>{o&&o.end(1),a=ce(e,V,{}),a.start()}),c=!0)},o(i){a&&a.invalidate(),o=ue(e,V,{}),c=!1},d(i){i&&p(e),i&&o&&o.end()}}}function gt(l){let e,t,s,a,o,c,i,r,S,x,u,j,se,ee,C,le,W,H,ae,U,F,Y,R,ie,Pe,M,pe,A,T,z,qe,de,_e,J,Z,G,te,je,Re,Ae,D,Te,he,ne,be,ze,Oe;e=new ot({});let g=l[4].username&&(l[7]||l[1])&&Ye(l);H=new at({});let v=l[4].email&&l[7]&&Ze(l);function Se(n,d){return n[5]?_t:dt}let ge=Se(l),N=ge(l);const Be=[bt,ht],$=[];function Ve(n,d){return n[5]?0:1}T=Ve(l),z=$[T]=Be[T](l);let w=l[4].password&&l[7]&&Ge(l),k=l[4].form&&$e(l);return{c(){ye(e.$$.fragment),t=I(),s=_("main"),a=_("section"),o=_("h1"),c=L("Register"),i=I(),r=_("form"),S=_("label"),x=L("Username"),u=I(),j=_("input"),se=I(),g&&g.c(),ee=I(),C=_("label"),le=L("Email "),W=_("span"),ye(H.$$.fragment),ae=I(),U=_("input"),F=I(),v&&v.c(),Y=I(),R=_("label"),ie=L("Password"),Pe=I(),M=_("div"),N.c(),pe=I(),A=_("button"),z.c(),qe=I(),w&&w.c(),de=I(),k&&k.c(),_e=I(),J=_("div"),Z=_("a"),G=_("button"),te=_("span"),je=L("Already a member?"),Re=L(" Log In"),Ae=I(),D=_("button"),Te=L("Register"),this.h()},l(n){Ee(e.$$.fragment,n),t=P(n),s=h(n,"MAIN",{class:!0});var d=y(s);a=h(d,"SECTION",{class:!0});var K=y(a);o=h(K,"H1",{class:!0});var Ce=y(o);c=O(Ce,"Register"),Ce.forEach(p),i=P(K),r=h(K,"FORM",{class:!0});var b=y(r);S=h(b,"LABEL",{for:!0});var We=y(S);x=O(We,"Username"),We.forEach(p),u=P(b),j=h(b,"INPUT",{id:!0}),se=P(b),g&&g.l(b),ee=P(b),C=h(b,"LABEL",{for:!0});var Ne=y(C);le=O(Ne,"Email "),W=h(Ne,"SPAN",{class:!0,title:!0});var He=y(W);Ee(H.$$.fragment,He),He.forEach(p),Ne.forEach(p),ae=P(b),U=h(b,"INPUT",{id:!0}),F=P(b),v&&v.l(b),Y=P(b),R=h(b,"LABEL",{for:!0});var Me=y(R);ie=O(Me,"Password"),Me.forEach(p),Pe=P(b),M=h(b,"DIV",{class:!0});var ve=y(M);N.l(ve),pe=P(ve),A=h(ve,"BUTTON",{type:!0,class:!0});var De=y(A);z.l(De),De.forEach(p),ve.forEach(p),qe=P(b),w&&w.l(b),de=P(b),k&&k.l(b),_e=P(b),J=h(b,"DIV",{class:!0});var we=y(J);Z=h(we,"A",{class:!0,href:!0});var Fe=y(Z);G=h(Fe,"BUTTON",{class:!0});var Le=y(G);te=h(Le,"SPAN",{class:!0});var Je=y(te);je=O(Je,"Already a member?"),Je.forEach(p),Re=O(Le," Log In"),Le.forEach(p),Fe.forEach(p),Ae=P(we),D=h(we,"BUTTON",{type:!0,class:!0});var Ke=y(D);Te=O(Ke,"Register"),Ke.forEach(p),we.forEach(p),b.forEach(p),K.forEach(p),d.forEach(p),this.h()},h(){m(o,"class","svelte-wl0o75"),m(S,"for","register-username"),m(j,"id","register-username"),B(j,"disabled",l[6]),m(W,"class","tooltip-container"),m(W,"title","Your email is used log in and recover your account if your forget your password."),m(C,"for","register-email"),m(U,"id","register-email"),B(U,"disabled",l[6]),m(R,"for","register-password"),B(R,"disabled",l[6]),m(A,"type","button"),m(A,"class","secondary svelte-wl0o75"),B(A,"disabled",l[6]),m(M,"class","flex svelte-wl0o75"),m(te,"class","svelte-wl0o75"),m(G,"class","secondary svelte-wl0o75"),m(Z,"class","secondary svelte-wl0o75"),m(Z,"href","/log-in"),m(D,"type","submit"),m(D,"class","primary svelte-wl0o75"),B(D,"disabled",l[7]&&l[8]),m(J,"class","actions svelte-wl0o75"),m(r,"class","svelte-wl0o75"),m(a,"class","register svelte-wl0o75"),m(s,"class","svelte-wl0o75")},m(n,d){Ue(e,n,d),Q(n,t,d),Q(n,s,d),f(s,a),f(a,o),f(o,c),f(a,i),f(a,r),f(r,S),f(S,x),f(r,u),f(r,j),X(j,l[0]),f(r,se),g&&g.m(r,null),f(r,ee),f(r,C),f(C,le),f(C,W),Ue(H,W,null),f(r,ae),f(r,U),X(U,l[2]),f(r,F),v&&v.m(r,null),f(r,Y),f(r,R),f(R,ie),f(r,Pe),f(r,M),N.m(M,null),f(M,pe),f(M,A),$[T].m(A,null),f(r,qe),w&&w.m(r,null),f(r,de),k&&k.m(r,null),f(r,_e),f(r,J),f(J,Z),f(Z,G),f(G,te),f(te,je),f(G,Re),f(J,Ae),f(J,D),f(D,Te),be=!0,ze||(Oe=[re(j,"input",l[10]),re(U,"input",l[11]),re(A,"click",l[14]),re(r,"submit",rt(l[9]))],ze=!0)},p(n,[d]){d&1&&j.value!==n[0]&&X(j,n[0]),d&64&&B(j,"disabled",n[6]),n[4].username&&(n[7]||n[1])?g?(g.p(n,d),d&146&&E(g,1)):(g=Ye(n),g.c(),E(g,1),g.m(r,ee)):g&&(me(),q(g,1,1,()=>{g=null}),fe()),d&4&&U.value!==n[2]&&X(U,n[2]),d&64&&B(U,"disabled",n[6]),n[4].email&&n[7]?v?(v.p(n,d),d&144&&E(v,1)):(v=Ze(n),v.c(),E(v,1),v.m(r,Y)):v&&(me(),q(v,1,1,()=>{v=null}),fe()),d&64&&B(R,"disabled",n[6]),ge===(ge=Se(n))&&N?N.p(n,d):(N.d(1),N=ge(n),N&&(N.c(),N.m(M,pe)));let K=T;T=Ve(n),T!==K&&(me(),q($[K],1,1,()=>{$[K]=null}),fe(),z=$[T],z||(z=$[T]=Be[T](n),z.c()),E(z,1),z.m(A,null)),d&64&&B(A,"disabled",n[6]),n[4].password&&n[7]?w?(w.p(n,d),d&144&&E(w,1)):(w=Ge(n),w.c(),E(w,1),w.m(r,de)):w&&(me(),q(w,1,1,()=>{w=null}),fe()),n[4].form?k?(k.p(n,d),d&16&&E(k,1)):(k=$e(n),k.c(),E(k,1),k.m(r,_e)):k&&(me(),q(k,1,1,()=>{k=null}),fe()),d&384&&B(D,"disabled",n[7]&&n[8])},i(n){be||(E(e.$$.fragment,n),E(g),E(H.$$.fragment,n),E(v),E(z),E(w),E(k),oe(()=>{ne&&ne.end(1),he=ce(a,V,{}),he.start()}),be=!0)},o(n){q(e.$$.fragment,n),q(g),q(H.$$.fragment,n),q(v),q(z),q(w),q(k),he&&he.invalidate(),ne=ue(a,V,{}),be=!1},d(n){Ie(e,n),n&&p(t),n&&p(s),g&&g.d(),Ie(H),v&&v.d(),N.d(),$[T].d(),w&&w.d(),k&&k.d(),n&&ne&&ne.end(),ze=!1,st(Oe)}}}function vt(l,e,t){let s;const{debounce:a}=lt;let o="",c=!1,i="",r="",S=!0,x=!1,u={username:"",email:"",password:"",form:""},j=!1;const se=async()=>{if(t(7,j=!0),s)return;t(6,x=!0);let U=!1;await ut(async()=>{var F;try{const[Y,R]=await Promise.all([ft("/verify-email"),fetch(`${Qe.viteSveltekitHost}/proxy/register`,Xe({query:pt,variables:{userRegistrationInput:{username:o,email:i,password:r}}})).then(async ie=>await ie.json())]);if((F=R==null?void 0:R.error)==null?void 0:F.message)throw R.error.message;U=!0}catch(Y){if(Y==="A user with that username already exists. Please try another."){t(1,c=!0);return}t(4,u.form="An unknown error occurred. Please try again later.",u)}}),U&&await ct("/verify-email")},ee=a(async()=>{const U=await fetch(`${Qe.viteSveltekitHost}/proxy/user-where`,Xe({query:mt("id"),variables:{where:{username:o}}})).then(async F=>await F.json());t(1,c=!!U)},500);function C(){o=this.value,t(0,o)}function le(){i=this.value,t(2,i)}function W(){r=this.value,t(3,r)}function H(){r=this.value,t(3,r)}const ae=()=>t(5,S=!S);return l.$$.update=()=>{l.$$.dirty&19&&t(4,u=(()=>o?o.length<2?(t(4,u.username="Username must be at least 2 characters",u),u):o.match(/^(?=.{2,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$/)?c?(t(4,u.username="Username is taken. Please choose another.",u),u):(t(4,u.username="",u),u):(t(4,u.username="Username must be alphanumeric. Periods and underscores may only be used as separators.",u),u):(t(4,u.username="Username is required",u),u))()),l.$$.dirty&20&&t(4,u=(()=>i?i.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/)?(t(4,u.email="",u),u):(t(4,u.email="Email address format invalid",u),u):(t(4,u.email="Email address is required",u),u))()),l.$$.dirty&24&&t(4,u=(()=>r?r.length<8?(t(4,u.password="Password must be at least 8 characters in length",u),u):(t(4,u.password="",u),u):(t(4,u.password="Password is required",u),u))()),l.$$.dirty&16&&t(8,s=Object.values(u).some(U=>!!U)),l.$$.dirty&1&&o&&ee()},[o,c,i,r,u,S,x,j,s,se,C,le,W,H,ae]}class Tt extends xe{constructor(e){super();et(this,e,vt,gt,tt,{})}}export{Tt as default};
