FROM ubuntu

# Turbo requires git for hashing
RUN apt update
RUN apt install -y git

# Install nodejs
RUN apt-get install curl -y
RUN curl -fsSL https://deb.nodesource.com/setup_16.x | sh -
RUN apt-get install -y nodejs

# Install pnpm
RUN npm install -g pnpm


# Create app directory
RUN mkdir -p /home/app

# Copy monorepo files from host
COPY . /home/app

RUN cd /home/app && pnpm add turbo -DW && pnpm install && pnpm deploy

CMD ["pnpm", "start"]